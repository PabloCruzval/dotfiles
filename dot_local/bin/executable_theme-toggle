#!/bin/bash

# Script to toggle between light and dark mode for GTK apps
# Usage: theme-toggle [light|dark|toggle]

STATE_FILE="$HOME/.cache/theme-mode"

# Create state file if it doesn't exist
if [ ! -f "$STATE_FILE" ]; then
    echo "dark" > "$STATE_FILE"
fi

# Function to set dark mode
set_dark() {
    echo "dark" > "$STATE_FILE"
    
    # Use gsettings (GTK apps will respond via XDG Desktop Portal)
    gsettings set org.gnome.desktop.interface color-scheme "prefer-dark"
    gsettings set org.gnome.desktop.interface gtk-theme "Adwaita-dark"
    
    notify-send "Tema" "Modo oscuro activado" -i weather-clear-night
}

# Function to set light mode
set_light() {
    echo "light" > "$STATE_FILE"
    
    # Use gsettings (GTK apps will respond via XDG Desktop Portal)
    gsettings set org.gnome.desktop.interface color-scheme "prefer-light"
    gsettings set org.gnome.desktop.interface gtk-theme "Adwaita"
    
    notify-send "Tema" "Modo claro activado" -i weather-clear
}

# Main logic
case "${1:-toggle}" in
    light)
        set_light
        ;;
    dark)
        set_dark
        ;;
    toggle)
        CURRENT=$(cat "$STATE_FILE")
        if [ "$CURRENT" = "dark" ]; then
            set_light
        else
            set_dark
        fi
        ;;
    *)
        echo "Usage: theme-toggle [light|dark|toggle]"
        exit 1
        ;;
esac
